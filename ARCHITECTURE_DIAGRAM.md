# ğŸ—ï¸ Architektura Systemu - Polish Players Tracker

## ğŸ“Š Diagram Kompletny

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                 â”‚
â”‚                         ğŸ‘¤ UÅ»YTKOWNIK (PrzeglÄ…darka)                            â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ HTTPS
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                 â”‚
â”‚                    â˜ï¸ STREAMLIT CLOUD (Frontend Layer)                          â”‚
â”‚                    https://yourapp.streamlit.app                                â”‚
â”‚                    ğŸ†“ FREE TIER: Unlimited users, 1GB RAM                       â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  ğŸ“± streamlit_app_cloud.py                                              â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚
â”‚  â”‚  â”‚  Dashboard    â”‚  â”‚  Player      â”‚  â”‚  Comparison         â”‚         â”‚   â”‚
â”‚  â”‚  â”‚  - Tabela     â”‚  â”‚  Cards       â”‚  â”‚  - Side by side     â”‚         â”‚   â”‚
â”‚  â”‚  â”‚  - Filtry     â”‚  â”‚  - Details   â”‚  â”‚  - Charts (Plotly)  â”‚         â”‚   â”‚
â”‚  â”‚  â”‚  - Search     â”‚  â”‚  - Stats     â”‚  â”‚  - xG comparison    â”‚         â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  Dependencies (requirements-streamlit.txt):                            â”‚   â”‚
â”‚  â”‚  - streamlit==1.51.0                                                   â”‚   â”‚
â”‚  â”‚  - pandas==2.3.3                                                       â”‚   â”‚
â”‚  â”‚  - plotly==5.18.0                                                      â”‚   â”‚
â”‚  â”‚  - requests==2.32.5                                                    â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”‚  Secrets (.streamlit/secrets.toml):                                            â”‚
â”‚  â”œâ”€â”€ BACKEND_API_URL = "https://polish-players-tracker.onrender.com"           â”‚
â”‚  â””â”€â”€ DEBUG = false                                                              â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ REST API (HTTPS)
                                     â”‚ GET /api/players
                                     â”‚ GET /api/stats/{player_id}
                                     â”‚ GET /api/comparison
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                 â”‚
â”‚                    ğŸš€ RENDER.COM (Backend Layer)                                â”‚
â”‚                    https://polish-players-tracker-xxxx.onrender.com             â”‚
â”‚                    ğŸ†“ FREE TIER: 750h/month, 512MB RAM, 1GB Disk                â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  ğŸ”§ FastAPI Backend (app/backend/main.py)                               â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚  API Endpoints:                                                â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ GET  /health                 (Health check)              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ GET  /api/players            (Lista graczy)              â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ GET  /api/players/{id}       (SzczegÃ³Å‚y gracza)          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ GET  /api/stats              (Statystyki)                â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ GET  /api/comparison         (PorÃ³wnanie)                â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€ GET  /api/matches            (Mecze)                     â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  Middleware:                                                            â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ CORS (allow all origins)                                          â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Logging                                                            â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”‚                                     â”‚                                           â”‚
â”‚                                     â–¼                                           â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  ğŸ’¾ PostgreSQL Database (Supabase)                                       â”‚   â”‚
â”‚  â”‚  Cloud-hosted with automatic backups (500MB free)                       â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  Tabele:                                                                â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  players         â”‚  â”‚  competition_stats  â”‚  â”‚  player_matches  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - id           â”‚  â”‚  - player_id        â”‚  â”‚  - player_id     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - name         â”‚  â”‚  - season           â”‚  â”‚  - match_date    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - position     â”‚  â”‚  - competition_type â”‚  â”‚  - opponent      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - team         â”‚  â”‚  - games            â”‚  â”‚  - competition   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - nationality  â”‚  â”‚  - goals            â”‚  â”‚  - minutes       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - fbref_id     â”‚  â”‚  - assists          â”‚  â”‚  - goals         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - created_at   â”‚  â”‚  - xg, xa, npxg     â”‚  â”‚  - assists       â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚   â”‚
â”‚  â”‚  â”‚  season_stats    â”‚  â”‚  goalkeeper_stats   â”‚                         â”‚   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                         â”‚   â”‚
â”‚  â”‚  â”‚  - player_id    â”‚  â”‚  - player_id        â”‚                         â”‚   â”‚
â”‚  â”‚  â”‚  - season       â”‚  â”‚  - season           â”‚                         â”‚   â”‚
â”‚  â”‚  â”‚  - league       â”‚  â”‚  - saves            â”‚                         â”‚   â”‚
â”‚  â”‚  â”‚  - total stats  â”‚  â”‚  - clean_sheets     â”‚                         â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”‚                                     â–²                                           â”‚
â”‚                                     â”‚                                           â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  ğŸ¤– APScheduler (Background Jobs)                                       â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚  Zadania:                                                      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ sync_all_players()    co 6h    â”                         â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ sync_match_logs()     co 12h   â”œâ”€ Data update    â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ cleanup_old_data()    co 24h   â”‚                         â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€ health_check()        co 10min â”˜  (keep-alive)           â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”‚                                     â”‚                                           â”‚
â”‚                                     â–¼                                           â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  ğŸ­ Playwright Scraper (services/fbref_playwright_scraper.py)           â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  Flow:                                                                  â”‚   â”‚
â”‚  â”‚  1. Launch headless Chromium                                           â”‚   â”‚
â”‚  â”‚  2. Navigate to FBref.com/players/{fbref_id}                           â”‚   â”‚
â”‚  â”‚  3. Parse HTML (BeautifulSoup)                                         â”‚   â”‚
â”‚  â”‚  4. Extract: stats, matches, xG/xA data                                â”‚   â”‚
â”‚  â”‚  5. Save to database                                                   â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â”‚  Features:                                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Stealth mode (evade detection)                                    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Retry logic (3 attempts)                                          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Rate limiting (1 req/5s)                                          â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Error handling & logging                                          â”‚   â”‚
â”‚  â”‚                                                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ HTTPS (Web Scraping)
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚                  â”‚
                            â”‚  ğŸ“Š FBref.com    â”‚
                            â”‚  (Å¹rÃ³dÅ‚o danych) â”‚
                            â”‚                  â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ PrzepÅ‚yw Danych

### 1. Aktualizacja Danych (Background)
```
Scheduler (co 6h)
    â†“
Playwright Scraper
    â†“
FBref.com â†’ Parse HTML â†’ Extract Stats
    â†“
PostgreSQL Database (Supabase)
```

### 2. WyÅ›wietlanie Danych (User Request)
```
User (Browser)
    â†“
Streamlit Cloud (Frontend)
    â†“
REST API Request â†’ Render Backend (FastAPI)
    â†“
Query PostgreSQL Database
    â†“
Return JSON Response
    â†“
Streamlit Cloud â†’ Render UI
    â†“
User sees Dashboard
```

---

## ğŸ“¦ Komponenty

### Frontend (Streamlit Cloud)
| Komponent | Plik | Opis |
|-----------|------|------|
| **Main App** | `streamlit_app_cloud.py` | GÅ‚Ã³wna aplikacja UI |
| **Pages** | `pages/2_âš–ï¸_compare_players.py` | PorÃ³wnanie graczy |
| **Config** | `.streamlit/config.toml` | Konfiguracja Streamlit |
| **Secrets** | `.streamlit/secrets.toml` | Zmienne Å›rodowiskowe |

### Backend (Render)
| Komponent | Plik | Opis |
|-----------|------|------|
| **API** | `app/backend/main.py` | FastAPI endpoints |
| **Models** | `app/backend/models/*.py` | SQLAlchemy models |
| **Routers** | `app/backend/routers/*.py` | API route handlers |
| **Services** | `app/backend/services/*.py` | Business logic |
| **Scraper** | `services/fbref_playwright_scraper.py` | Web scraping |

### Database (PostgreSQL)
| Tabela | Rekordy | Opis |
|--------|---------|------|
| **players** | ~100 | Podstawowe info o graczach |
| **competition_stats** | ~1000 | Statystyki per sezon/rozgrywki |
| **player_matches** | ~5000 | SzczegÃ³Å‚owe mecze z datami |
| **season_stats** | ~300 | Statystyki sezonowe agregowane |
| **goalkeeper_stats** | ~50 | Specjalne statystyki bramkarzy |

---

## ğŸŒ Network Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚
â”‚  Browser    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ HTTPS (443)
       â”‚ GET https://yourapp.streamlit.app
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Streamlit Cloud    â”‚
â”‚  CDN/Load Balancer  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Render App
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  streamlit_app.py   â”‚
â”‚  - Load secrets     â”‚
â”‚  - BACKEND_API_URL  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ HTTPS API Call
       â”‚ GET https://backend.onrender.com/api/players?limit=10
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Render.com         â”‚
â”‚  Load Balancer      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Route to container
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FastAPI Backend    â”‚
â”‚  Docker Container   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ SQLAlchemy ORM
       â”‚ SELECT * FROM players LIMIT 10
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SQLite Database    â”‚
â”‚  /data/players.db   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¾ Storage

### Persistent Disk (Render)
```
/data/
â”œâ”€â”€ players.db          (gÅ‚Ã³wna baza ~50MB)
â”œâ”€â”€ logs/
â”‚   â”œâ”€â”€ app.log        (logi aplikacji)
â”‚   â””â”€â”€ scraper.log    (logi scrapera)
â””â”€â”€ backups/
    â””â”€â”€ players.db.backup (backup co 24h)
```

### Streamlit Cloud (Ephemeral)
```
/app/
â”œâ”€â”€ streamlit_app_cloud.py
â”œâ”€â”€ requirements-streamlit.txt
â”œâ”€â”€ .streamlit/
â”‚   â””â”€â”€ config.toml
â””â”€â”€ cache/              (cache danych, znika przy redeploy)
```

---

## ğŸ” Security & Authentication

### Current (v0.7.3)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚  No authentication
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  (Public access)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend   â”‚  No API keys required
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend    â”‚  CORS: allow all origins
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  (Open API)
```

### Future (Production)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚  OAuth login
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  (Google/GitHub)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend   â”‚  JWT token in headers
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend    â”‚  API Key validation
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  Rate limiting
```

---

## ğŸ“Š Performance

### Caching Strategy

**Frontend (Streamlit):**
```python
@st.cache_data(ttl=3600)  # 1 hour
def get_players():
    return requests.get(f"{BACKEND_API_URL}/api/players")

@st.cache_data(ttl=300)  # 5 minutes
def get_player_stats(player_id):
    return requests.get(f"{BACKEND_API_URL}/api/stats/{player_id}")
```

**Backend (FastAPI):**
```python
# In-memory cache
cache = TTLCache(maxsize=100, ttl=3600)

@app.get("/api/players")
@cached(cache)
def get_players():
    return db.query(Player).all()
```

### Response Times
| Endpoint | Cold Start | Warm | Cached |
|----------|-----------|------|--------|
| `/health` | 30-60s | <100ms | - |
| `/api/players` | 30-60s | 200-500ms | <50ms |
| `/api/stats/{id}` | 30-60s | 300-800ms | <50ms |
| Frontend load | 2-5s | 1-2s | <1s |

---

## ğŸ”„ Deployment Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Developer                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ git push origin main
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GitHub Repository                                           â”‚
â”‚  - Webhook triggers deploy                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                            â”‚
             â”‚ Webhook                    â”‚ Webhook
             â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Streamlit Cloud        â”‚  â”‚  Render.com                  â”‚
â”‚  1. Clone repo          â”‚  â”‚  1. Clone repo               â”‚
â”‚  2. pip install -r      â”‚  â”‚  2. docker build             â”‚
â”‚     requirements-       â”‚  â”‚  3. docker push              â”‚
â”‚     streamlit.txt       â”‚  â”‚  4. Deploy container         â”‚
â”‚  3. streamlit run       â”‚  â”‚  5. Health check             â”‚
â”‚  4. Deploy (1-2 min)    â”‚  â”‚  6. Route traffic (5-10 min) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                            â”‚
             â–¼                            â–¼
      âœ… Live                       âœ… Live
```

---

## ğŸ†š Architektura: SQLite vs PostgreSQL

### Option A: SQLite (Current)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend    â”‚
â”‚  Container  â”‚
â”‚     â†“       â”‚
â”‚  SQLite     â”‚  Pros: Simple, fast, no config
â”‚  File       â”‚  Cons: Single writer, local only
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Option B: PostgreSQL (Production)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend    â”‚ â”€â”€â”€â†’ â”‚  PostgreSQL  â”‚  Pros: Multi-user, ACID, backups
â”‚  Container  â”‚      â”‚  (Supabase)  â”‚  Cons: More complex, network latency
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Scalability

### Current Limits (Free Tier)
| Resource | Limit | Enough For |
|----------|-------|------------|
| Database Size | 1 GB | ~100k players |
| RAM (Backend) | 512 MB | ~100 concurrent users |
| RAM (Frontend) | 1 GB | ~500 concurrent users |
| CPU (Backend) | Shared | Light API calls |
| CPU (Frontend) | Shared | Dashboard rendering |

### When to Upgrade?
- **>100 players** â†’ Consider PostgreSQL
- **>1000 concurrent users** â†’ Paid Streamlit plan
- **>10k requests/day** â†’ Paid Render plan
- **Need SLA** â†’ Production infrastructure

---

## ğŸ¯ Podsumowanie

**Aktualna Architektura (v0.7.3):**
- âœ… Frontend: Streamlit Cloud (Free)
- âœ… Backend: Render.com (Free)
- âœ… Database: SQLite (Persistent Disk)
- âœ… Scraper: Playwright (Background jobs)
- âœ… Cost: **$0/month**
- âœ… Uptime: 24/7 (z cold start)

**Idealna dla:**
- ğŸ“š Projekty edukacyjne
- ğŸ’¼ Portfolio
- ğŸ§ª Prototypy
- ğŸ‘¥ <1000 uÅ¼ytkownikÃ³w/dzieÅ„

**Gotowe na:**
- ğŸš€ Deployment (15 minut)
- ğŸ”„ Auto-updates (GitHub push)
- ğŸ“Š Monitoring (Dashboard)
- ğŸ› Debugging (Logs)

---

**Data:** 25.11.2025  
**Wersja:** v0.7.3  
**Status:** âœ… Production Ready
